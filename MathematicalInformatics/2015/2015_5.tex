\documentclass[a4paper, 10pt, dvipdfmx]{jlreq}

\usepackage{amsmath,amsfonts,amssymb}
\usepackage{bm}
\usepackage{mathtools}
\usepackage{siunitx}
\usepackage[dvipdfmx]{graphicx}
\usepackage[dvipdfmx]{color}
\usepackage[dvipdfmx, colorlinks=true, allcolors=blue]{hyperref}
\usepackage{listings, jlisting}
\usepackage{tikz}
\usepackage{physics}
\usepackage{url}

\Urlmuskip=0mu plus 10mu
\allowdisplaybreaks[4]
\frenchspacing
\definecolor{OliveGreen}{rgb}{0.0,0.6,0.0}
\definecolor{Orenge}{rgb}{0.89,0.55,0}
\definecolor{SkyBlue}{rgb}{0.28, 0.28, 0.95}
\lstset{
  language={c++},
  basicstyle={\ttfamily},
  identifierstyle={\small},
  ndkeywordstyle={\small},
  frame=single,
  breaklines=true,
  numbers=left,
  xrightmargin=0zw,
  xleftmargin=3zw,
  numberstyle={\scriptsize},
  lineskip=-0.9ex,
  keywordstyle={\small\bfseries\color{SkyBlue}},  
  commentstyle={\color{OliveGreen}}, 
  stringstyle={\small\ttfamily\color{Orenge}}    
}

\begin{document}

\title{2015年度 大問5}
\author{hari64boli64 (hari64boli64@gmail.com)}
\date{\today}
\maketitle

\section{問題}

$$
  D_i=\{ j \in \mathbb{N} | 1 \leq j < i, S[j]=S[i] \}
$$

\begin{align*}
  d(i)=
  \begin{cases}
    i-\max D_i & (D_i \neq \emptyset) \\
    i          & (D_i = \emptyset)
  \end{cases}
\end{align*}

\section{解答}

\href{./5.py}{5.py}が解答。

\lstinputlisting[caption=answer,label=code:answer,language=Python]{5.py}

\begin{lstlisting}[caption=output, label=code:output]
sigma=7, n=7, k=5
S=[1, 3, 5, 4, 4, 7, 7]
Ds=[[], [], [], [], [4], [], [6]]
ds=[1, 2, 3, 4, 1, 6, 1]
----------
sigma=5, n=8, k=4
S=[3, 5, 2, 5, 2, 3, 2, 1]
Ds=[[], [], [], [2], [3], [1], [3, 5], []]
ds=[1, 2, 3, 2, 2, 5, 2, 8]
----------
sigma=10, n=5, k=5
S=[9, 10, 3, 5, 2]
Ds=[[], [], [], [], []]
ds=[1, 2, 3, 4, 5]
----------
sigma=2, n=6, k=2
S=[2, 1, 2, 2, 2, 1]
Ds=[[], [], [1], [1, 3], [1, 3, 4], [2]]
ds=[1, 2, 2, 1, 1, 4]
----------
sigma=9, n=8, k=6
S=[8, 9, 5, 1, 9, 1, 2, 7]
Ds=[[], [], [], [], [2], [4], [], []]
ds=[1, 2, 3, 4, 3, 2, 7, 8]
==========
sigma=19, n=8087, k=19
sum(math.log(d) for d in ds)=19935.714435979888
n*math.log(k)=23811.678024519002
----------
sigma=1397, n=38, k=35
sum(math.log(d) for d in ds)=96.64773012539216
n*math.log(k)=135.10322633659771
----------
sigma=8410, n=3796, k=3077
sum(math.log(d) for d in ds)=26698.671661842043
n*math.log(k)=30488.372584722474
----------
sigma=7194, n=6237, k=4169
sum(math.log(d) for d in ds)=45840.86686343042
n*math.log(k)=51988.08612754253
----------
sigma=8530, n=4156, k=3267
sum(math.log(d) for d in ds)=29505.23672883638
n*math.log(k)=33628.80352261405
\end{lstlisting}


\end{document}
