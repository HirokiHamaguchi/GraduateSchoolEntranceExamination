\documentclass[a4paper, 10pt, dvipdfmx]{jlreq}

\usepackage{amsmath,amsfonts,amssymb}
\usepackage{bm}
\usepackage{mathtools}
\usepackage{siunitx}
\usepackage[dvipdfmx]{graphicx}
\usepackage[dvipdfmx]{color}
\usepackage[dvipdfmx, colorlinks=true, allcolors=blue]{hyperref}
\usepackage{listings}
\usepackage{tikz}
\usepackage{physics}
\usepackage{url}

\Urlmuskip=0mu plus 10mu
\allowdisplaybreaks[4]
\frenchspacing
\definecolor{OliveGreen}{rgb}{0.0,0.6,0.0}
\definecolor{Orenge}{rgb}{0.89,0.55,0}
\definecolor{SkyBlue}{rgb}{0.28, 0.28, 0.95}
\lstset{
  language={c++},
  basicstyle={\ttfamily},
  identifierstyle={\small},
  ndkeywordstyle={\small},
  frame=single,
  breaklines=true,
  numbers=left,
  xrightmargin=0zw,
  xleftmargin=3zw,
  numberstyle={\scriptsize},
  lineskip=-0.9ex,
  keywordstyle={\small\bfseries\color{SkyBlue}},  
  commentstyle={\color{OliveGreen}}, 
  stringstyle={\small\ttfamily\color{Orenge}}    
}

\begin{document}

\title{2017年度 大問2}
\author{hari64boli64 (hari64boli64@gmail.com)}
\date{\today}
\maketitle

\section{問題}

コイン投げ

\section{解答}

\subsection*{(1)}

漸化式を解く。

\begin{align*}
  \qty(\frac{1}{2} - \frac{1-\theta_B}{2-\theta_A-\theta_B}) \qty(-1+\theta_A+\theta_B)^{n-1}+\frac{1-\theta_B}{2-\theta_A-\theta_B}
\end{align*}

\subsection*{(2)}

漸化式を解く。

\begin{align*}
  \frac{\theta_A+\theta_B-2\theta_A\theta_B}{2-\theta_A-\theta_B}
\end{align*}

\subsection*{(3)}

比較する。

\begin{align*}
  \frac{\theta_A+\theta_B-2\theta_A\theta_B}{2-\theta_A-\theta_B} - \frac{\theta_A+\theta_B}{2} & = 2(2-\theta_A-\theta_B)(\theta_A-\theta_B)^2 \\
                                                                                                & \geq 0
\end{align*}


\section{おまけ}

\lstinputlisting[caption=2,label=code:2,language=Python]{2.py}

\begin{lstlisting}[caption=result, label=code:result]
theta_A=0.3, theta_B=0.3
problem1(n)=0.5, NthCoinIsA=0.5025
problem2()=0.3, Hn=0.30355699999999997

theta_A=0.3, theta_B=0.5
problem1(n)=0.4166666666666667, NthCoinIsA=0.4172
problem2()=0.4166666666666667, Hn=0.420066

theta_A=0.3, theta_B=0.7
problem1(n)=0.30000000000000004, NthCoinIsA=0.2929
problem2()=0.5800000000000001, Hn=0.5850310000000001

theta_A=0.5, theta_B=0.3
problem1(n)=0.5833333333333334, NthCoinIsA=0.582
problem2()=0.4166666666666667, Hn=0.421361

theta_A=0.5, theta_B=0.5
problem1(n)=0.5, NthCoinIsA=0.506
problem2()=0.5, Hn=0.504502

theta_A=0.5, theta_B=0.7
problem1(n)=0.37500000000000006, NthCoinIsA=0.3812
problem2()=0.625, Hn=0.631972

theta_A=0.7, theta_B=0.3
problem1(n)=0.7, NthCoinIsA=0.6978
problem2()=0.5800000000000001, Hn=0.585776

theta_A=0.7, theta_B=0.5
problem1(n)=0.625, NthCoinIsA=0.6327
problem2()=0.625, Hn=0.630889

theta_A=0.7, theta_B=0.7
problem1(n)=0.5, NthCoinIsA=0.4996
problem2()=0.7, Hn=0.707874
\end{lstlisting}


\end{document}
